=> DBGInvoke __enable_schema_sync_service('false')

=> DBGInvoke __drop_tidb_table(default, test)
=> drop table if exists default.test
=> drop table if exists default.test_p1
=> drop table if exists default.test_p2

=> DBGInvoke __mock_tidb_table(default, test, 'col_1 String, col_2 Int64')
=> DBGInvoke __mock_tidb_partition(default, test, p1)
=> DBGInvoke __mock_tidb_partition(default, test, p2)

=> DBGInvoke __put_region(4, 0, 100, default, test, p1)
=> DBGInvoke __raft_insert_row(default, test, 4, 50, 'test1', 1)
=> DBGInvoke __raft_insert_row(default, test, 4, 51, 'test2', 2)
=> DBGInvoke __try_flush_region(4)

=> DBGInvoke __put_region(5, 100, 200, default, test, p2)
=> DBGInvoke __raft_insert_row(default, test, 5, 152, 'test3', 3)
=> DBGInvoke __raft_insert_row(default, test, 5, 153, 'test4', 4)
=> DBGInvoke __try_flush_region(5)

=> DBGInvoke __rename_table_for_partition(default, test, p1, test_p1)
=> DBGInvoke __rename_table_for_partition(default, test, p2, test_p2)

=> select avg(col_2) from default.test_p1
┌─avg(col_2)─┐
│        1.5 │
└────────────┘

=> select count(*) from default.test_p1
┌─count()─┐
│       2 │
└─────────┘

=> select avg(col_2) from default.test_p2
┌─avg(col_2)─┐
│        3.5 │
└────────────┘

=> select count(*) from default.test_p2
┌─count()─┐
│       2 │
└─────────┘

=> DBGInvoke __drop_tidb_table(default, test)
=> drop table if exists default.test
=> drop table if exists default.test_p1
=> drop table if exists default.test_p2
=> DBGInvoke __enable_schema_sync_service('true')
