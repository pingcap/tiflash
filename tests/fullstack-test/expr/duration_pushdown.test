# Preparation.
=> DBGInvoke __init_fail_point()

mysql> drop table if exists test.t;
mysql> create table if not exists test.t(a time(4));

mysql> insert into test.t values('700:10:10.123456');
mysql> insert into test.t values('-700:10:10.123456');
mysql> alter table test.t set tiflash replica 1;
func> wait_table test t

mysql> use test; set tidb_enforce_mpp=1; set tidb_isolation_read_engines='tiflash'; select a from t;
+-----------------+
| a               |
+-----------------+
| 700:10:10.1235  |
| -700:10:10.1235 |
+-----------------+

mysql> use test; set tidb_enforce_mpp=1; set tidb_isolation_read_engines='tiflash'; select t1.a from t t1 join t t2 on t1.a=t2.a;
+-----------------+
| a               |
+-----------------+
| 700:10:10.1235  |
| -700:10:10.1235 |
+-----------------+

mysql> use test; set tidb_enforce_mpp=1; set tidb_isolation_read_engines='tiflash'; select a='700:10:10.123500' from t;
+----------------------+
| a='700:10:10.123500' |
+----------------------+
|                    1 |
|                    0 |
+----------------------+

=> DBGInvoke __enable_fail_point(force_remote_read_for_batch_cop)
mysql> use test; set tidb_enforce_mpp=1; set tidb_isolation_read_engines='tiflash'; select a from t;
+-----------------+
| a               |
+-----------------+
| 700:10:10.1235  |
| -700:10:10.1235 |
+-----------------+

mysql> use test; set tidb_enforce_mpp=1; set tidb_isolation_read_engines='tiflash'; select t1.a from t t1 join t t2 on t1.a=t2.a;
+-----------------+
| a               |
+-----------------+
| 700:10:10.1235  |
| -700:10:10.1235 |
+-----------------+

mysql> use test; set tidb_enforce_mpp=1; set tidb_isolation_read_engines='tiflash'; select a='700:10:10.123500' from t;
+----------------------+
| a='700:10:10.123500' |
+----------------------+
|                    1 |
|                    0 |
+----------------------+

=> DBGInvoke __disable_fail_point(force_remote_read_for_batch_cop)
# Clean up.
mysql> drop table if exists test.t
