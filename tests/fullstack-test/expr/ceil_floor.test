mysql> drop table if exists test.t
mysql> create table test.t(ld decimal(10,2), bd decimal(50, 25), f float, i integer)
mysql> alter table test.t set tiflash replica 1
mysql> insert into test.t values(1.2, 2.3, 3.4, 4)

func> wait_table test t


mysql> select /*+ read_from_storage(tiflash[t]) */ ceil(ld), ceil(bd), ceil(f), ceil(i) from test.t;
+----------+----------+---------+---------+
| ceil(ld) | ceil(bd) | ceil(f) | ceil(i) |
+----------+----------+---------+---------+
|        2 |        3 |       4 |       4 |
+----------+----------+---------+---------+

mysql> select /*+ read_from_storage(tiflash[t]) */ floor(ld), floor(bd), floor(f), ceil(i) from test.t;
+-----------+-----------+----------+---------+
| floor(ld) | floor(bd) | floor(f) | ceil(i) |
+-----------+-----------+----------+---------+
|         1 |         2 |        3 |       4 |
+-----------+-----------+----------+---------+

mysql> drop table if exists test.t