# const frac

# for integer round, TiDB's behavior is different from MySQL.
# we choose MySQL's result here.

mysql> drop table if exists test.i8
mysql> create table test.i8 (id bigint, a tinyint)
mysql> alter table test.i8 set tiflash replica 1
mysql> insert into test.i8 values (1, 0), (2, 1), (3, -1), (4, 49), (5, 50), (6, -49), (7, -50), (8, 127), (9, -128), (10, null)
func> wait_table test i8
mysql> set @@session.tidb_isolation_read_engines='tiflash'; select sum(a), sum(round(a, 1)), sum(round(a, 0)), sum(round(a, -1)), sum(round(a, -2)), sum(round(a, -3)), sum(round(a, -4)) from test.i8 group by id order by id
+--------+------------------+------------------+-------------------+-------------------+-------------------+-------------------+
| sum(a) | sum(round(a, 1)) | sum(round(a, 0)) | sum(round(a, -1)) | sum(round(a, -2)) | sum(round(a, -3)) | sum(round(a, -4)) |
+--------+------------------+------------------+-------------------+-------------------+-------------------+-------------------+
|      0 |                0 |                0 |                 0 |                 0 |                 0 |                 0 |
|      1 |                1 |                1 |                 0 |                 0 |                 0 |                 0 |
|     -1 |               -1 |               -1 |                 0 |                 0 |                 0 |                 0 |
|     49 |               49 |               49 |                50 |                 0 |                 0 |                 0 |
|     50 |               50 |               50 |                50 |               100 |                 0 |                 0 |
|    -49 |              -49 |              -49 |               -50 |                 0 |                 0 |                 0 |
|    -50 |              -50 |              -50 |               -50 |              -100 |                 0 |                 0 |
|    127 |              127 |              127 |               130 |               100 |                 0 |                 0 |
|   -128 |             -128 |             -128 |              -130 |              -100 |                 0 |                 0 |
|   NULL |             NULL |             NULL |              NULL |              NULL |              NULL |              NULL |
+--------+------------------+------------------+-------------------+-------------------+-------------------+-------------------+

mysql> drop table if exists test.u8
mysql> create table test.u8 (id bigint, a tinyint unsigned)
mysql> alter table test.u8 set tiflash replica 1
mysql> insert into test.u8 values (1, 0), (2, 4), (3, 5), (4, 49), (5, 50), (6, 255), (7, null)
func> wait_table test u8
mysql> set @@session.tidb_isolation_read_engines='tiflash'; select sum(a), sum(round(a, 1)), sum(round(a, 0)), sum(round(a, -1)), sum(round(a, -2)), sum(round(a, -3)), sum(round(a, -4)) from test.u8 group by id order by id
+--------+------------------+------------------+-------------------+-------------------+-------------------+-------------------+
| sum(a) | sum(round(a, 1)) | sum(round(a, 0)) | sum(round(a, -1)) | sum(round(a, -2)) | sum(round(a, -3)) | sum(round(a, -4)) |
+--------+------------------+------------------+-------------------+-------------------+-------------------+-------------------+
|      0 |                0 |                0 |                 0 |                 0 |                 0 |                 0 |
|      4 |                4 |                4 |                 0 |                 0 |                 0 |                 0 |
|      5 |                5 |                5 |                10 |                 0 |                 0 |                 0 |
|     49 |               49 |               49 |                50 |                 0 |                 0 |                 0 |
|     50 |               50 |               50 |                50 |               100 |                 0 |                 0 |
|    255 |              255 |              255 |               260 |               300 |                 0 |                 0 |
|   NULL |             NULL |             NULL |              NULL |              NULL |              NULL |              NULL |
+--------+------------------+------------------+-------------------+-------------------+-------------------+-------------------+

mysql> drop table if exists test.i64
mysql> create table test.i64 (id bigint, a bigint)
mysql> alter table test.i64 set tiflash replica 1
mysql> insert into test.i64 values (1, 0), (2, 4), (3, 5), (4, -4), (5, -5), (6, 4999999999999999999), (7, 5000000000000000000), (8, -4999999999999999999), (9, -5000000000000000000), (10, 9223372036854775807), (11, -9223372036854775808), (12, null)
func> wait_table test i64
mysql> set @@session.tidb_isolation_read_engines='tiflash'; select sum(a), sum(round(a, 1)), sum(round(a, 0)), sum(round(a, -1)), sum(round(a, -2)), sum(round(a, -18)), sum(round(a, -19)), sum(round(a, -20)) from test.i64 group by id order by id
+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+--------------------+
| sum(a)               | sum(round(a, 1))     | sum(round(a, 0))     | sum(round(a, -1))    | sum(round(a, -2))    | sum(round(a, -18))   | sum(round(a, -19))   | sum(round(a, -20)) |
+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+--------------------+
|                    0 |                    0 |                    0 |                    0 |                    0 |                    0 |                    0 |                  0 |
|                    4 |                    4 |                    4 |                    0 |                    0 |                    0 |                    0 |                  0 |
|                    5 |                    5 |                    5 |                   10 |                    0 |                    0 |                    0 |                  0 |
|                   -4 |                   -4 |                   -4 |                    0 |                    0 |                    0 |                    0 |                  0 |
|                   -5 |                   -5 |                   -5 |                  -10 |                    0 |                    0 |                    0 |                  0 |
|  4999999999999999999 |  4999999999999999999 |  4999999999999999999 |  5000000000000000000 |  5000000000000000000 |  5000000000000000000 |                    0 |                  0 |
|  5000000000000000000 |  5000000000000000000 |  5000000000000000000 |  5000000000000000000 |  5000000000000000000 |  5000000000000000000 | -8446744073709551616 |                  0 |
| -4999999999999999999 | -4999999999999999999 | -4999999999999999999 | -5000000000000000000 | -5000000000000000000 | -5000000000000000000 |                    0 |                  0 |
| -5000000000000000000 | -5000000000000000000 | -5000000000000000000 | -5000000000000000000 | -5000000000000000000 | -5000000000000000000 |  8446744073709551616 |                  0 |
|  9223372036854775807 |  9223372036854775807 |  9223372036854775807 | -9223372036854775806 |  9223372036854775800 |  9000000000000000000 | -8446744073709551616 |                  0 |
| -9223372036854775808 | -9223372036854775808 | -9223372036854775808 |  9223372036854775806 | -9223372036854775800 | -9000000000000000000 |  8446744073709551616 |                  0 |
|                 NULL |                 NULL |                 NULL |                 NULL |                 NULL |                 NULL |                 NULL |               NULL |
+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+----------------------+--------------------+

mysql> drop table if exists test.u64
mysql> create table test.u64 (id bigint, a bigint unsigned)
mysql> alter table test.u64 set tiflash replica 1
mysql> insert into test.u64 values (1, 0), (2, 4), (3, 5), (4, 4999999999999999999), (5, 5000000000000000000), (6, 18446744073709551615), (7, null)
func> wait_table test u64
mysql> set @@session.tidb_isolation_read_engines='tiflash'; select sum(a), sum(round(a, 1)), sum(round(a, 0)), sum(round(a, -1)), sum(round(a, -2)), sum(round(a, -16)), sum(round(a, -18)), sum(round(a, -19)), sum(round(a, -20)) from test.u64 group by id order by id
+----------------------+----------------------+----------------------+---------------------+----------------------+---------------------+----------------------+----------------------+--------------------+
| sum(a)               | sum(round(a, 1))     | sum(round(a, 0))     | sum(round(a, -1))   | sum(round(a, -2))    | sum(round(a, -16))  | sum(round(a, -18))   | sum(round(a, -19))   | sum(round(a, -20)) |
+----------------------+----------------------+----------------------+---------------------+----------------------+---------------------+----------------------+----------------------+--------------------+
|                    0 |                    0 |                    0 |                   0 |                    0 |                   0 |                    0 |                    0 |                  0 |
|                    4 |                    4 |                    4 |                   0 |                    0 |                   0 |                    0 |                    0 |                  0 |
|                    5 |                    5 |                    5 |                  10 |                    0 |                   0 |                    0 |                    0 |                  0 |
|  4999999999999999999 |  4999999999999999999 |  4999999999999999999 | 5000000000000000000 |  5000000000000000000 | 5000000000000000000 |  5000000000000000000 |                    0 |                  0 |
|  5000000000000000000 |  5000000000000000000 |  5000000000000000000 | 5000000000000000000 |  5000000000000000000 | 5000000000000000000 |  5000000000000000000 | 10000000000000000000 |                  0 |
| 18446744073709551615 | 18446744073709551615 | 18446744073709551615 |                   4 | 18446744073709551600 |    3255926290448384 | 18000000000000000000 |  1553255926290448384 |                  0 |
|                 NULL |                 NULL |                 NULL |                NULL |                 NULL |                NULL |                 NULL |                 NULL |               NULL |
+----------------------+----------------------+----------------------+---------------------+----------------------+---------------------+----------------------+----------------------+--------------------+

mysql> drop table if exists test.f32
mysql> create table test.f32 (id bigint, a float)
mysql> alter table test.f32 set tiflash replica 1
mysql> insert into test.f32 values (1, 0), (2, 2.5), (3, -2.5), (4, 0.25), (5, -0.25), (6, 0.25e-10), (7, -0.25e-10), (8, 49e10), (9, 50e10), (10, -49e10), (11, -50e10), (12, 0.3), (13, null)
func> wait_table test f32
mysql> set @@session.tidb_isolation_read_engines='tiflash'; select sum(a), sum(round(a, 2)), sum(round(a, 1)), sum(round(a, 0)), sum(round(a, -1)), sum(round(a, -2)) from test.f32 group by id order by id
+------------------------------+------------------+------------------+------------------+-------------------+-------------------+
| sum(a)                       | sum(round(a, 2)) | sum(round(a, 1)) | sum(round(a, 0)) | sum(round(a, -1)) | sum(round(a, -2)) |
+------------------------------+------------------+------------------+------------------+-------------------+-------------------+
|                            0 |             0.00 |              0.0 |                0 |                 0 |                 0 |
|                          2.5 |             2.50 |              2.5 |                2 |                 0 |                 0 |
|                         -2.5 |            -2.50 |             -2.5 |               -2 |                 0 |                 0 |
|                         0.25 |             0.25 |              0.2 |                0 |                 0 |                 0 |
|                        -0.25 |            -0.25 |             -0.2 |                0 |                 0 |                 0 |
|  0.0000000000250000003337858 |             0.00 |              0.0 |                0 |                 0 |                 0 |
| -0.0000000000250000003337858 |             0.00 |              0.0 |                0 |                 0 |                 0 |
|                 489999990784 |  489999990784.00 |   489999990784.0 |     489999990784 |      489999990780 |      489999990800 |
|                 499999997952 |  499999997952.00 |   499999997952.0 |     499999997952 |      499999997950 |      499999998000 |
|                -489999990784 | -489999990784.00 |  -489999990784.0 |    -489999990784 |     -489999990780 |     -489999990800 |
|                -499999997952 | -499999997952.00 |  -499999997952.0 |    -499999997952 |     -499999997950 |     -499999998000 |
|          0.30000001192092896 |             0.30 |              0.3 |                0 |                 0 |                 0 |
|                         NULL |             NULL |             NULL |             NULL |              NULL |              NULL |
+------------------------------+------------------+------------------+------------------+-------------------+-------------------+

mysql> set @@session.tidb_isolation_read_engines='tiflash'; select sum(a), sum(round(a, 8)), sum(round(a, 9)), sum(round(a, -9)), sum(round(a, -10)) from test.f32 group by id order by id
+------------------------------+------------------------+-------------------------+---------------------+--------------------+
| sum(a)                       | sum(round(a, 8))       | sum(round(a, 9))        | sum(round(a, -9))   | sum(round(a, -10)) |
+------------------------------+------------------------+-------------------------+---------------------+--------------------+
|                            0 |             0.00000000 |             0.000000000 |                   0 |                  0 |
|                          2.5 |             2.50000000 |             2.500000000 |                   0 |                  0 |
|                         -2.5 |            -2.50000000 |            -2.500000000 |                   0 |                  0 |
|                         0.25 |             0.25000000 |             0.250000000 |                   0 |                  0 |
|                        -0.25 |            -0.25000000 |            -0.250000000 |                   0 |                  0 |
|  0.0000000000250000003337858 |             0.00000000 |             0.000000000 |                   0 |                  0 |
| -0.0000000000250000003337858 |             0.00000000 |             0.000000000 |                   0 |                  0 |
|                 489999990784 |  489999990784.00000000 |  489999990784.000000000 |  489999999999.99994 |       490000000000 |
|                 499999997952 |  499999997952.00000000 |  499999997952.000000000 |  499999999999.99994 |       500000000000 |
|                -489999990784 | -489999990784.00000000 | -489999990784.000000000 | -489999999999.99994 |      -490000000000 |
|                -499999997952 | -499999997952.00000000 | -499999997952.000000000 | -499999999999.99994 |      -500000000000 |
|          0.30000001192092896 |             0.30000001 |             0.300000012 |                   0 |                  0 |
|                         NULL |                   NULL |                    NULL |                NULL |               NULL |
+------------------------------+------------------------+-------------------------+---------------------+--------------------+

mysql> set @@session.tidb_isolation_read_engines='tiflash'; select sum(a), sum(round(a, 30)), sum(round(a, -30)), sum(round(a, 1000000)), sum(round(a, -1000000)) from test.f32 group by id order by id
+------------------------------+----------------------------------------------+--------------------+----------------------------------------------+-------------------------+
| sum(a)                       | sum(round(a, 30))                            | sum(round(a, -30)) | sum(round(a, 1000000))                       | sum(round(a, -1000000)) |
+------------------------------+----------------------------------------------+--------------------+----------------------------------------------+-------------------------+
|                            0 |             0.000000000000000000000000000000 |                  0 |             0.000000000000000000000000000000 |                       0 |
|                          2.5 |             2.500000000000000000000000000000 |                  0 |             2.500000000000000000000000000000 |                       0 |
|                         -2.5 |            -2.500000000000000000000000000000 |                  0 |            -2.500000000000000000000000000000 |                       0 |
|                         0.25 |             0.250000000000000000000000000000 |                  0 |             0.250000000000000000000000000000 |                       0 |
|                        -0.25 |            -0.250000000000000000000000000000 |                  0 |            -0.250000000000000000000000000000 |                       0 |
|  0.0000000000250000003337858 |             0.000000000025000000333785799000 |                  0 |             0.000000000025000000333785799000 |                       0 |
| -0.0000000000250000003337858 |            -0.000000000025000000333785799000 |                  0 |            -0.000000000025000000333785799000 |                       0 |
|                 489999990784 |  489999990784.000000000000000000000000000000 |                  0 |  489999990784.000000000000000000000000000000 |                       0 |
|                 499999997952 |  499999997952.000000000000000000000000000000 |                  0 |  499999997952.000000000000000000000000000000 |                       0 |
|                -489999990784 | -489999990784.000000000000000000000000000000 |                  0 | -489999990784.000000000000000000000000000000 |                       0 |
|                -499999997952 | -499999997952.000000000000000000000000000000 |                  0 | -499999997952.000000000000000000000000000000 |                       0 |
|          0.30000001192092896 |             0.300000011920928955078125000000 |                  0 |             0.300000011920928955078125000000 |                       0 |
|                         NULL |                                         NULL |               NULL |                                         NULL |                    NULL |
+------------------------------+----------------------------------------------+--------------------+----------------------------------------------+-------------------------+

mysql> drop table if exists test.f64
mysql> create table test.f64 (id bigint, a double)
mysql> alter table test.f64 set tiflash replica 1
mysql> insert into test.f64 values (1, 0), (2, 2.5), (3, -2.5), (4, 0.25), (5, -0.25), (6, 0.25e-10), (7, -0.25e-10), (8, 49e10), (9, 50e10), (10, -49e10), (11, -50e10), (12, 0.3), (13, null)
func> wait_table test f64
mysql> set @@session.tidb_isolation_read_engines='tiflash'; select sum(a), sum(round(a, 2)), sum(round(a, 1)), sum(round(a, 0)), sum(round(a, -1)), sum(round(a, -2)) from test.f64 group by id order by id
+-----------------+------------------+------------------+------------------+-------------------+-------------------+
| sum(a)          | sum(round(a, 2)) | sum(round(a, 1)) | sum(round(a, 0)) | sum(round(a, -1)) | sum(round(a, -2)) |
+-----------------+------------------+------------------+------------------+-------------------+-------------------+
|               0 |             0.00 |              0.0 |                0 |                 0 |                 0 |
|             2.5 |             2.50 |              2.5 |                2 |                 0 |                 0 |
|            -2.5 |            -2.50 |             -2.5 |               -2 |                 0 |                 0 |
|            0.25 |             0.25 |              0.2 |                0 |                 0 |                 0 |
|           -0.25 |            -0.25 |             -0.2 |                0 |                 0 |                 0 |
|  0.000000000025 |             0.00 |              0.0 |                0 |                 0 |                 0 |
| -0.000000000025 |             0.00 |              0.0 |                0 |                 0 |                 0 |
|    490000000000 |  490000000000.00 |   490000000000.0 |     490000000000 |      490000000000 |      490000000000 |
|    500000000000 |  500000000000.00 |   500000000000.0 |     500000000000 |      500000000000 |      500000000000 |
|   -490000000000 | -490000000000.00 |  -490000000000.0 |    -490000000000 |     -490000000000 |     -490000000000 |
|   -500000000000 | -500000000000.00 |  -500000000000.0 |    -500000000000 |     -500000000000 |     -500000000000 |
|             0.3 |             0.30 |              0.3 |                0 |                 0 |                 0 |
|            NULL |             NULL |             NULL |             NULL |              NULL |              NULL |
+-----------------+------------------+------------------+------------------+-------------------+-------------------+

mysql> set @@session.tidb_isolation_read_engines='tiflash'; select sum(a), sum(round(a, 8)), sum(round(a, 9)), sum(round(a, -9)), sum(round(a, -10)) from test.f64 group by id order by id
+-----------------+------------------------+-------------------------+---------------------+--------------------+
| sum(a)          | sum(round(a, 8))       | sum(round(a, 9))        | sum(round(a, -9))   | sum(round(a, -10)) |
+-----------------+------------------------+-------------------------+---------------------+--------------------+
|               0 |             0.00000000 |             0.000000000 |                   0 |                  0 |
|             2.5 |             2.50000000 |             2.500000000 |                   0 |                  0 |
|            -2.5 |            -2.50000000 |            -2.500000000 |                   0 |                  0 |
|            0.25 |             0.25000000 |             0.250000000 |                   0 |                  0 |
|           -0.25 |            -0.25000000 |            -0.250000000 |                   0 |                  0 |
|  0.000000000025 |             0.00000000 |             0.000000000 |                   0 |                  0 |
| -0.000000000025 |             0.00000000 |             0.000000000 |                   0 |                  0 |
|    490000000000 |  490000000000.00000000 |  490000000000.000000000 |  489999999999.99994 |       490000000000 |
|    500000000000 |  500000000000.00000000 |  500000000000.000000000 |  499999999999.99994 |       500000000000 |
|   -490000000000 | -490000000000.00000000 | -490000000000.000000000 | -489999999999.99994 |      -490000000000 |
|   -500000000000 | -500000000000.00000000 | -500000000000.000000000 | -499999999999.99994 |      -500000000000 |
|             0.3 |             0.30000000 |             0.300000000 |                   0 |                  0 |
|            NULL |                   NULL |                    NULL |                NULL |               NULL |
+-----------------+------------------------+-------------------------+---------------------+--------------------+

mysql> set @@session.tidb_isolation_read_engines='tiflash'; select sum(a), sum(round(a, 30)), sum(round(a, -30)), sum(round(a, 1000000)), sum(round(a, -1000000)) from test.f64 group by id order by id
+-----------------+----------------------------------------------+--------------------+----------------------------------------------+-------------------------+
| sum(a)          | sum(round(a, 30))                            | sum(round(a, -30)) | sum(round(a, 1000000))                       | sum(round(a, -1000000)) |
+-----------------+----------------------------------------------+--------------------+----------------------------------------------+-------------------------+
|               0 |             0.000000000000000000000000000000 |                  0 |             0.000000000000000000000000000000 |                       0 |
|             2.5 |             2.500000000000000000000000000000 |                  0 |             2.500000000000000000000000000000 |                       0 |
|            -2.5 |            -2.500000000000000000000000000000 |                  0 |            -2.500000000000000000000000000000 |                       0 |
|            0.25 |             0.250000000000000000000000000000 |                  0 |             0.250000000000000000000000000000 |                       0 |
|           -0.25 |            -0.250000000000000000000000000000 |                  0 |            -0.250000000000000000000000000000 |                       0 |
|  0.000000000025 |             0.000000000025000000000000000911 |                  0 |             0.000000000025000000000000000911 |                       0 |
| -0.000000000025 |            -0.000000000025000000000000000911 |                  0 |            -0.000000000025000000000000000911 |                       0 |
|    490000000000 |  490000000000.000000000000000000000000000000 |                  0 |  490000000000.000000000000000000000000000000 |                       0 |
|    500000000000 |  500000000000.000000000000000000000000000000 |                  0 |  500000000000.000000000000000000000000000000 |                       0 |
|   -490000000000 | -490000000000.000000000000000000000000000000 |                  0 | -490000000000.000000000000000000000000000000 |                       0 |
|   -500000000000 | -500000000000.000000000000000000000000000000 |                  0 | -500000000000.000000000000000000000000000000 |                       0 |
|             0.3 |             0.299999999999999988897769753748 |                  0 |             0.299999999999999988897769753748 |                       0 |
|            NULL |                                         NULL |               NULL |                                         NULL |                    NULL |
+-----------------+----------------------------------------------+--------------------+----------------------------------------------+-------------------------+

mysql> drop table if exists test.d9
mysql> create table test.d9 (id bigint, a decimal(9, 4))
mysql> alter table test.d9 set tiflash replica 1
mysql> insert into test.d9 values (1, 0), (2, 0.25), (3, -0.25), (4, 0.0499), (5, 0.05), (6, -0.0499), (7, -0.05), (8, 49999.9999), (9, 50000), (10, -49999.9999), (11, -50000), (12, 99999.9999), (13, -99999.9999), (14, 25), (15, -25), (16, null)
func> wait_table test d9
mysql> set @@session.tidb_isolation_read_engines='tiflash'; select sum(a), sum(round(a, -1)), sum(round(a, 0)), sum(round(a, 1)) from test.d9 group by id order by id
+-------------+-------------------+------------------+------------------+
| sum(a)      | sum(round(a, -1)) | sum(round(a, 0)) | sum(round(a, 1)) |
+-------------+-------------------+------------------+------------------+
|      0.0000 |                 0 |                0 |              0.0 |
|      0.2500 |                 0 |                0 |              0.3 |
|     -0.2500 |                 0 |                0 |             -0.3 |
|      0.0499 |                 0 |                0 |              0.0 |
|      0.0500 |                 0 |                0 |              0.1 |
|     -0.0499 |                 0 |                0 |              0.0 |
|     -0.0500 |                 0 |                0 |             -0.1 |
|  49999.9999 |             50000 |            50000 |          50000.0 |
|  50000.0000 |             50000 |            50000 |          50000.0 |
| -49999.9999 |            -50000 |           -50000 |         -50000.0 |
| -50000.0000 |            -50000 |           -50000 |         -50000.0 |
|  99999.9999 |            100000 |           100000 |         100000.0 |
| -99999.9999 |           -100000 |          -100000 |        -100000.0 |
|     25.0000 |                30 |               25 |             25.0 |
|    -25.0000 |               -30 |              -25 |            -25.0 |
|        NULL |              NULL |             NULL |             NULL |
+-------------+-------------------+------------------+------------------+

mysql> set @@session.tidb_isolation_read_engines='tiflash'; select sum(a), sum(round(a, 3)), sum(round(a, 4)), sum(round(a, 5)), sum(round(a, 40)) from test.d9 group by id order by id
+-------------+------------------+------------------+------------------+---------------------------------------+
| sum(a)      | sum(round(a, 3)) | sum(round(a, 4)) | sum(round(a, 5)) | sum(round(a, 40))                     |
+-------------+------------------+------------------+------------------+---------------------------------------+
|      0.0000 |            0.000 |           0.0000 |          0.00000 |      0.000000000000000000000000000000 |
|      0.2500 |            0.250 |           0.2500 |          0.25000 |      0.250000000000000000000000000000 |
|     -0.2500 |           -0.250 |          -0.2500 |         -0.25000 |     -0.250000000000000000000000000000 |
|      0.0499 |            0.050 |           0.0499 |          0.04990 |      0.049900000000000000000000000000 |
|      0.0500 |            0.050 |           0.0500 |          0.05000 |      0.050000000000000000000000000000 |
|     -0.0499 |           -0.050 |          -0.0499 |         -0.04990 |     -0.049900000000000000000000000000 |
|     -0.0500 |           -0.050 |          -0.0500 |         -0.05000 |     -0.050000000000000000000000000000 |
|  49999.9999 |        50000.000 |       49999.9999 |      49999.99990 |  49999.999900000000000000000000000000 |
|  50000.0000 |        50000.000 |       50000.0000 |      50000.00000 |  50000.000000000000000000000000000000 |
| -49999.9999 |       -50000.000 |      -49999.9999 |     -49999.99990 | -49999.999900000000000000000000000000 |
| -50000.0000 |       -50000.000 |      -50000.0000 |     -50000.00000 | -50000.000000000000000000000000000000 |
|  99999.9999 |       100000.000 |       99999.9999 |      99999.99990 |  99999.999900000000000000000000000000 |
| -99999.9999 |      -100000.000 |      -99999.9999 |     -99999.99990 | -99999.999900000000000000000000000000 |
|     25.0000 |           25.000 |          25.0000 |         25.00000 |     25.000000000000000000000000000000 |
|    -25.0000 |          -25.000 |         -25.0000 |        -25.00000 |    -25.000000000000000000000000000000 |
|        NULL |             NULL |             NULL |             NULL |                                  NULL |
+-------------+------------------+------------------+------------------+---------------------------------------+

mysql> set @@session.tidb_isolation_read_engines='tiflash'; select sum(a), sum(round(a, -4)), sum(round(a, -5)), sum(round(a, -6)), sum(round(a, -100)) from test.d9 group by id order by id
+-------------+-------------------+-------------------+-------------------+---------------------+
| sum(a)      | sum(round(a, -4)) | sum(round(a, -5)) | sum(round(a, -6)) | sum(round(a, -100)) |
+-------------+-------------------+-------------------+-------------------+---------------------+
|      0.0000 |                 0 |                 0 |                 0 |                   0 |
|      0.2500 |                 0 |                 0 |                 0 |                   0 |
|     -0.2500 |                 0 |                 0 |                 0 |                   0 |
|      0.0499 |                 0 |                 0 |                 0 |                   0 |
|      0.0500 |                 0 |                 0 |                 0 |                   0 |
|     -0.0499 |                 0 |                 0 |                 0 |                   0 |
|     -0.0500 |                 0 |                 0 |                 0 |                   0 |
|  49999.9999 |             50000 |                 0 |                 0 |                   0 |
|  50000.0000 |             50000 |            100000 |                 0 |                   0 |
| -49999.9999 |            -50000 |                 0 |                 0 |                   0 |
| -50000.0000 |            -50000 |           -100000 |                 0 |                   0 |
|  99999.9999 |            100000 |            100000 |                 0 |                   0 |
| -99999.9999 |           -100000 |           -100000 |                 0 |                   0 |
|     25.0000 |                 0 |                 0 |                 0 |                   0 |
|    -25.0000 |                 0 |                 0 |                 0 |                   0 |
|        NULL |              NULL |              NULL |              NULL |                NULL |
+-------------+-------------------+-------------------+-------------------+---------------------+

mysql> drop table if exists test.d64
mysql> create table test.d64 (id bigint, a decimal(64, 2))
mysql> alter table test.d64 set tiflash replica 1
mysql> insert into test.d64 values (1, 0), (2, 0.25), (3, -0.25), (4, 25), (5, -25), (6, 49999999999999999999999999999999999999999999999999999999999999.99), (7, 50000000000000000000000000000000000000000000000000000000000000), (8, -49999999999999999999999999999999999999999999999999999999999999.99), (9, -50000000000000000000000000000000000000000000000000000000000000), (10, 0.49), (11, 0.5), (12, -0.49), (13, -0.5), (14, 99999999999999999999999999999999999999999999999999999999999999.99), (15, -99999999999999999999999999999999999999999999999999999999999999.99), (16, null)
func> wait_table test d64
mysql> set @@session.tidb_isolation_read_engines='tiflash'; select sum(a), sum(round(a, -1)), sum(round(a, 0)), sum(round(a, 1)) from test.d64 group by id order by id
+--------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------------------------------------+--------------------------------------------------------------------+
| sum(a)                                                             | sum(round(a, -1))                                                | sum(round(a, 0))                                                 | sum(round(a, 1))                                                   |
+--------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------------------------------------+--------------------------------------------------------------------+
|                                                               0.00 |                                                                0 |                                                                0 |                                                                0.0 |
|                                                               0.25 |                                                                0 |                                                                0 |                                                                0.3 |
|                                                              -0.25 |                                                                0 |                                                                0 |                                                               -0.3 |
|                                                              25.00 |                                                               30 |                                                               25 |                                                               25.0 |
|                                                             -25.00 |                                                              -30 |                                                              -25 |                                                              -25.0 |
|  49999999999999999999999999999999999999999999999999999999999999.99 |   50000000000000000000000000000000000000000000000000000000000000 |   50000000000000000000000000000000000000000000000000000000000000 |   50000000000000000000000000000000000000000000000000000000000000.0 |
|  50000000000000000000000000000000000000000000000000000000000000.00 |   50000000000000000000000000000000000000000000000000000000000000 |   50000000000000000000000000000000000000000000000000000000000000 |   50000000000000000000000000000000000000000000000000000000000000.0 |
| -49999999999999999999999999999999999999999999999999999999999999.99 |  -50000000000000000000000000000000000000000000000000000000000000 |  -50000000000000000000000000000000000000000000000000000000000000 |  -50000000000000000000000000000000000000000000000000000000000000.0 |
| -50000000000000000000000000000000000000000000000000000000000000.00 |  -50000000000000000000000000000000000000000000000000000000000000 |  -50000000000000000000000000000000000000000000000000000000000000 |  -50000000000000000000000000000000000000000000000000000000000000.0 |
|                                                               0.49 |                                                                0 |                                                                0 |                                                                0.5 |
|                                                               0.50 |                                                                0 |                                                                1 |                                                                0.5 |
|                                                              -0.49 |                                                                0 |                                                                0 |                                                               -0.5 |
|                                                              -0.50 |                                                                0 |                                                               -1 |                                                               -0.5 |
|  99999999999999999999999999999999999999999999999999999999999999.99 |  100000000000000000000000000000000000000000000000000000000000000 |  100000000000000000000000000000000000000000000000000000000000000 |  100000000000000000000000000000000000000000000000000000000000000.0 |
| -99999999999999999999999999999999999999999999999999999999999999.99 | -100000000000000000000000000000000000000000000000000000000000000 | -100000000000000000000000000000000000000000000000000000000000000 | -100000000000000000000000000000000000000000000000000000000000000.0 |
|                                                               NULL |                                                             NULL |                                                             NULL |                                                               NULL |
+--------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------------------------------------+--------------------------------------------------------------------+

mysql> set @@session.tidb_isolation_read_engines='tiflash'; select sum(a), sum(round(a, 2)), sum(round(a, -61)), sum(round(a, -62)) from test.d64 group by id order by id
+--------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------------------------------------+
| sum(a)                                                             | sum(round(a, 2))                                                   | sum(round(a, -61))                                               | sum(round(a, -62))                                               |
+--------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------------------------------------+
|                                                               0.00 |                                                               0.00 |                                                                0 |                                                                0 |
|                                                               0.25 |                                                               0.25 |                                                                0 |                                                                0 |
|                                                              -0.25 |                                                              -0.25 |                                                                0 |                                                                0 |
|                                                              25.00 |                                                              25.00 |                                                                0 |                                                                0 |
|                                                             -25.00 |                                                             -25.00 |                                                                0 |                                                                0 |
|  49999999999999999999999999999999999999999999999999999999999999.99 |  49999999999999999999999999999999999999999999999999999999999999.99 |   50000000000000000000000000000000000000000000000000000000000000 |                                                                0 |
|  50000000000000000000000000000000000000000000000000000000000000.00 |  50000000000000000000000000000000000000000000000000000000000000.00 |   50000000000000000000000000000000000000000000000000000000000000 |  100000000000000000000000000000000000000000000000000000000000000 |
| -49999999999999999999999999999999999999999999999999999999999999.99 | -49999999999999999999999999999999999999999999999999999999999999.99 |  -50000000000000000000000000000000000000000000000000000000000000 |                                                                0 |
| -50000000000000000000000000000000000000000000000000000000000000.00 | -50000000000000000000000000000000000000000000000000000000000000.00 |  -50000000000000000000000000000000000000000000000000000000000000 | -100000000000000000000000000000000000000000000000000000000000000 |
|                                                               0.49 |                                                               0.49 |                                                                0 |                                                                0 |
|                                                               0.50 |                                                               0.50 |                                                                0 |                                                                0 |
|                                                              -0.49 |                                                              -0.49 |                                                                0 |                                                                0 |
|                                                              -0.50 |                                                              -0.50 |                                                                0 |                                                                0 |
|  99999999999999999999999999999999999999999999999999999999999999.99 |  99999999999999999999999999999999999999999999999999999999999999.99 |  100000000000000000000000000000000000000000000000000000000000000 |  100000000000000000000000000000000000000000000000000000000000000 |
| -99999999999999999999999999999999999999999999999999999999999999.99 | -99999999999999999999999999999999999999999999999999999999999999.99 | -100000000000000000000000000000000000000000000000000000000000000 | -100000000000000000000000000000000000000000000000000000000000000 |
|                                                               NULL |                                                               NULL |                                                             NULL |                                                             NULL |
+--------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------------------------------------+

mysql> set @@session.tidb_isolation_read_engines='tiflash'; select sum(a), sum(round(a, -63)), sum(round(a, -100)) from test.d64 group by id order by id
+--------------------------------------------------------------------+--------------------+---------------------+
| sum(a)                                                             | sum(round(a, -63)) | sum(round(a, -100)) |
+--------------------------------------------------------------------+--------------------+---------------------+
|                                                               0.00 |                  0 |                   0 |
|                                                               0.25 |                  0 |                   0 |
|                                                              -0.25 |                  0 |                   0 |
|                                                              25.00 |                  0 |                   0 |
|                                                             -25.00 |                  0 |                   0 |
|  49999999999999999999999999999999999999999999999999999999999999.99 |                  0 |                   0 |
|  50000000000000000000000000000000000000000000000000000000000000.00 |                  0 |                   0 |
| -49999999999999999999999999999999999999999999999999999999999999.99 |                  0 |                   0 |
| -50000000000000000000000000000000000000000000000000000000000000.00 |                  0 |                   0 |
|                                                               0.49 |                  0 |                   0 |
|                                                               0.50 |                  0 |                   0 |
|                                                              -0.49 |                  0 |                   0 |
|                                                              -0.50 |                  0 |                   0 |
|  99999999999999999999999999999999999999999999999999999999999999.99 |                  0 |                   0 |
| -99999999999999999999999999999999999999999999999999999999999999.99 |                  0 |                   0 |
|                                                               NULL |               NULL |                NULL |
+--------------------------------------------------------------------+--------------------+---------------------+

# const input, variable frac

mysql> drop table if exists test.t
mysql> create table test.t (i bigint)
mysql> alter table test.t set tiflash replica 1
mysql> insert into test.t values (-66), (-65), (-64), (-63), (-62), (-61), (-60), (-59), (-58), (-57), (-56), (-55), (-54), (-53), (-52), (-51), (-50), (-49), (-48), (-47), (-46), (-45), (-44), (-43), (-42), (-41), (-40), (-39), (-38), (-37), (-36), (-35), (-34), (-33), (-32), (-31), (-30), (-29), (-28), (-27), (-26), (-25), (-24), (-23), (-22), (-21), (-20), (-19), (-18), (-17), (-16), (-15), (-14), (-13), (-12), (-11), (-10), (-9), (-8), (-7), (-6), (-5), (-4), (-3), (-2), (-1), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (10), (11), (12), (13), (14), (15), (16), (17), (18), (19), (20), (21), (22), (23), (24), (25), (26), (27), (28), (29), (30), (31), (9223372036854775807), (-9223372036854775808)
func> wait_table test t

mysql> set @@session.tidb_isolation_read_engines='tiflash'; select i, round(-123456789123456789, i) from test.t group by i order by i
+----------------------+-------------------------------+
| i                    | round(-123456789123456789, i) |
+----------------------+-------------------------------+
| -9223372036854775808 |                             0 |
|                  -66 |                             0 |
|                  -65 |                             0 |
|                  -64 |                             0 |
|                  -63 |                             0 |
|                  -62 |                             0 |
|                  -61 |                             0 |
|                  -60 |                             0 |
|                  -59 |                             0 |
|                  -58 |                             0 |
|                  -57 |                             0 |
|                  -56 |                             0 |
|                  -55 |                             0 |
|                  -54 |                             0 |
|                  -53 |                             0 |
|                  -52 |                             0 |
|                  -51 |                             0 |
|                  -50 |                             0 |
|                  -49 |                             0 |
|                  -48 |                             0 |
|                  -47 |                             0 |
|                  -46 |                             0 |
|                  -45 |                             0 |
|                  -44 |                             0 |
|                  -43 |                             0 |
|                  -42 |                             0 |
|                  -41 |                             0 |
|                  -40 |                             0 |
|                  -39 |                             0 |
|                  -38 |                             0 |
|                  -37 |                             0 |
|                  -36 |                             0 |
|                  -35 |                             0 |
|                  -34 |                             0 |
|                  -33 |                             0 |
|                  -32 |                             0 |
|                  -31 |                             0 |
|                  -30 |                             0 |
|                  -29 |                             0 |
|                  -28 |                             0 |
|                  -27 |                             0 |
|                  -26 |                             0 |
|                  -25 |                             0 |
|                  -24 |                             0 |
|                  -23 |                             0 |
|                  -22 |                             0 |
|                  -21 |                             0 |
|                  -20 |                             0 |
|                  -19 |                             0 |
|                  -18 |                             0 |
|                  -17 |           -100000000000000000 |
|                  -16 |           -120000000000000000 |
|                  -15 |           -122999999999999984 |
|                  -14 |           -123500000000000000 |
|                  -13 |           -123460000000000000 |
|                  -12 |           -123457000000000000 |
|                  -11 |           -123456800000000000 |
|                  -10 |           -123456790000000000 |
|                   -9 |           -123456789000000000 |
|                   -8 |           -123456789100000000 |
|                   -7 |           -123456789120000000 |
|                   -6 |           -123456789123000000 |
|                   -5 |           -123456789123499984 |
|                   -4 |           -123456789123460000 |
|                   -3 |           -123456789123456992 |
|                   -2 |           -123456789123456800 |
|                   -1 |           -123456789123456800 |
|                    0 |           -123456789123456784 |
|                    1 |           -123456789123456800 |
|                    2 |           -123456789123456784 |
|                    3 |           -123456789123456784 |
|                    4 |           -123456789123456768 |
|                    5 |           -123456789123456768 |
|                    6 |           -123456789123456784 |
|                    7 |           -123456789123456784 |
|                    8 |           -123456789123456784 |
|                    9 |           -123456789123456784 |
|                   10 |           -123456789123456784 |
|                   11 |           -123456789123456784 |
|                   12 |           -123456789123456784 |
|                   13 |           -123456789123456784 |
|                   14 |           -123456789123456784 |
|                   15 |           -123456789123456784 |
|                   16 |           -123456789123456784 |
|                   17 |           -123456789123456800 |
|                   18 |           -123456789123456784 |
|                   19 |           -123456789123456784 |
|                   20 |           -123456789123456768 |
|                   21 |           -123456789123456784 |
|                   22 |           -123456789123456784 |
|                   23 |           -123456789123456784 |
|                   24 |           -123456789123456784 |
|                   25 |           -123456789123456784 |
|                   26 |           -123456789123456784 |
|                   27 |           -123456789123456784 |
|                   28 |           -123456789123456784 |
|                   29 |           -123456789123456784 |
|                   30 |           -123456789123456784 |
|                   31 |           -123456789123456784 |
|  9223372036854775807 |           -123456789123456784 |
+----------------------+-------------------------------+

mysql> set @@session.tidb_isolation_read_engines='tiflash'; select i, round(123456789123456789.123456789123456789e0, i) from test.t group by i order by i
+----------------------+---------------------------------------------------+
| i                    | round(123456789123456789.123456789123456789e0, i) |
+----------------------+---------------------------------------------------+
| -9223372036854775808 |                                                 0 |
|                  -66 |                                                 0 |
|                  -65 |                                                 0 |
|                  -64 |                                                 0 |
|                  -63 |                                                 0 |
|                  -62 |                                                 0 |
|                  -61 |                                                 0 |
|                  -60 |                                                 0 |
|                  -59 |                                                 0 |
|                  -58 |                                                 0 |
|                  -57 |                                                 0 |
|                  -56 |                                                 0 |
|                  -55 |                                                 0 |
|                  -54 |                                                 0 |
|                  -53 |                                                 0 |
|                  -52 |                                                 0 |
|                  -51 |                                                 0 |
|                  -50 |                                                 0 |
|                  -49 |                                                 0 |
|                  -48 |                                                 0 |
|                  -47 |                                                 0 |
|                  -46 |                                                 0 |
|                  -45 |                                                 0 |
|                  -44 |                                                 0 |
|                  -43 |                                                 0 |
|                  -42 |                                                 0 |
|                  -41 |                                                 0 |
|                  -40 |                                                 0 |
|                  -39 |                                                 0 |
|                  -38 |                                                 0 |
|                  -37 |                                                 0 |
|                  -36 |                                                 0 |
|                  -35 |                                                 0 |
|                  -34 |                                                 0 |
|                  -33 |                                                 0 |
|                  -32 |                                                 0 |
|                  -31 |                                                 0 |
|                  -30 |                                                 0 |
|                  -29 |                                                 0 |
|                  -28 |                                                 0 |
|                  -27 |                                                 0 |
|                  -26 |                                                 0 |
|                  -25 |                                                 0 |
|                  -24 |                                                 0 |
|                  -23 |                                                 0 |
|                  -22 |                                                 0 |
|                  -21 |                                                 0 |
|                  -20 |                                                 0 |
|                  -19 |                                                 0 |
|                  -18 |                                                 0 |
|                  -17 |                                              1e17 |
|                  -16 |                                            1.2e17 |
|                  -15 |                             1.2299999999999998e17 |
|                  -14 |                                          1.235e17 |
|                  -13 |                                         1.2346e17 |
|                  -12 |                                        1.23457e17 |
|                  -11 |                                       1.234568e17 |
|                  -10 |                                      1.2345679e17 |
|                   -9 |                                     1.23456789e17 |
|                   -8 |                                    1.234567891e17 |
|                   -7 |                                   1.2345678912e17 |
|                   -6 |                                  1.23456789123e17 |
|                   -5 |                             1.2345678912349998e17 |
|                   -4 |                                1.2345678912346e17 |
|                   -3 |                               1.23456789123457e17 |
|                   -2 |                              1.234567891234568e17 |
|                   -1 |                              1.234567891234568e17 |
|                    0 |                             1.2345678912345678e17 |
|                    1 |                              1.234567891234568e17 |
|                    2 |                             1.2345678912345678e17 |
|                    3 |                             1.2345678912345678e17 |
|                    4 |                             1.2345678912345677e17 |
|                    5 |                             1.2345678912345677e17 |
|                    6 |                             1.2345678912345678e17 |
|                    7 |                             1.2345678912345678e17 |
|                    8 |                             1.2345678912345678e17 |
|                    9 |                             1.2345678912345678e17 |
|                   10 |                             1.2345678912345678e17 |
|                   11 |                             1.2345678912345678e17 |
|                   12 |                             1.2345678912345678e17 |
|                   13 |                             1.2345678912345678e17 |
|                   14 |                             1.2345678912345678e17 |
|                   15 |                             1.2345678912345678e17 |
|                   16 |                             1.2345678912345678e17 |
|                   17 |                              1.234567891234568e17 |
|                   18 |                             1.2345678912345678e17 |
|                   19 |                             1.2345678912345678e17 |
|                   20 |                             1.2345678912345677e17 |
|                   21 |                             1.2345678912345678e17 |
|                   22 |                             1.2345678912345678e17 |
|                   23 |                             1.2345678912345678e17 |
|                   24 |                             1.2345678912345678e17 |
|                   25 |                             1.2345678912345678e17 |
|                   26 |                             1.2345678912345678e17 |
|                   27 |                             1.2345678912345678e17 |
|                   28 |                             1.2345678912345678e17 |
|                   29 |                             1.2345678912345678e17 |
|                   30 |                             1.2345678912345678e17 |
|                   31 |                             1.2345678912345678e17 |
|  9223372036854775807 |                             1.2345678912345678e17 |
+----------------------+---------------------------------------------------+

mysql> set @@session.tidb_isolation_read_engines='tiflash'; select i, round(123456789123456789.123456789123456789, i) from test.t group by i order by i
+----------------------+-------------------------------------------------+
| i                    | round(123456789123456789.123456789123456789, i) |
+----------------------+-------------------------------------------------+
| -9223372036854775808 |                                               0 |
|                  -66 |                                               0 |
|                  -65 |                                               0 |
|                  -64 |                                               0 |
|                  -63 |                                               0 |
|                  -62 |                                               0 |
|                  -61 |                                               0 |
|                  -60 |                                               0 |
|                  -59 |                                               0 |
|                  -58 |                                               0 |
|                  -57 |                                               0 |
|                  -56 |                                               0 |
|                  -55 |                                               0 |
|                  -54 |                                               0 |
|                  -53 |                                               0 |
|                  -52 |                                               0 |
|                  -51 |                                               0 |
|                  -50 |                                               0 |
|                  -49 |                                               0 |
|                  -48 |                                               0 |
|                  -47 |                                               0 |
|                  -46 |                                               0 |
|                  -45 |                                               0 |
|                  -44 |                                               0 |
|                  -43 |                                               0 |
|                  -42 |                                               0 |
|                  -41 |                                               0 |
|                  -40 |                                               0 |
|                  -39 |                                               0 |
|                  -38 |                                               0 |
|                  -37 |                                               0 |
|                  -36 |                                               0 |
|                  -35 |                                               0 |
|                  -34 |                                               0 |
|                  -33 |                                               0 |
|                  -32 |                                               0 |
|                  -31 |                                               0 |
|                  -30 |                                               0 |
|                  -29 |                                               0 |
|                  -28 |                                               0 |
|                  -27 |                                               0 |
|                  -26 |                                               0 |
|                  -25 |                                               0 |
|                  -24 |                                               0 |
|                  -23 |                                               0 |
|                  -22 |                                               0 |
|                  -21 |                                               0 |
|                  -20 |                                               0 |
|                  -19 |                                               0 |
|                  -18 |                                               0 |
|                  -17 |                              100000000000000000 |
|                  -16 |                              120000000000000000 |
|                  -15 |                              123000000000000000 |
|                  -14 |                              123500000000000000 |
|                  -13 |                              123460000000000000 |
|                  -12 |                              123457000000000000 |
|                  -11 |                              123456800000000000 |
|                  -10 |                              123456790000000000 |
|                   -9 |                              123456789000000000 |
|                   -8 |                              123456789100000000 |
|                   -7 |                              123456789120000000 |
|                   -6 |                              123456789123000000 |
|                   -5 |                              123456789123500000 |
|                   -4 |                              123456789123460000 |
|                   -3 |                              123456789123457000 |
|                   -2 |                              123456789123456800 |
|                   -1 |                              123456789123456790 |
|                    0 |                              123456789123456789 |
|                    1 |                            123456789123456789.1 |
|                    2 |                           123456789123456789.12 |
|                    3 |                          123456789123456789.123 |
|                    4 |                         123456789123456789.1235 |
|                    5 |                        123456789123456789.12346 |
|                    6 |                       123456789123456789.123457 |
|                    7 |                      123456789123456789.1234568 |
|                    8 |                     123456789123456789.12345679 |
|                    9 |                    123456789123456789.123456789 |
|                   10 |                   123456789123456789.1234567891 |
|                   11 |                  123456789123456789.12345678912 |
|                   12 |                 123456789123456789.123456789123 |
|                   13 |                123456789123456789.1234567891235 |
|                   14 |               123456789123456789.12345678912346 |
|                   15 |              123456789123456789.123456789123457 |
|                   16 |             123456789123456789.1234567891234568 |
|                   17 |            123456789123456789.12345678912345679 |
|                   18 |           123456789123456789.123456789123456789 |
|                   19 |           123456789123456789.123456789123456789 |
|                   20 |           123456789123456789.123456789123456789 |
|                   21 |           123456789123456789.123456789123456789 |
|                   22 |           123456789123456789.123456789123456789 |
|                   23 |           123456789123456789.123456789123456789 |
|                   24 |           123456789123456789.123456789123456789 |
|                   25 |           123456789123456789.123456789123456789 |
|                   26 |           123456789123456789.123456789123456789 |
|                   27 |           123456789123456789.123456789123456789 |
|                   28 |           123456789123456789.123456789123456789 |
|                   29 |           123456789123456789.123456789123456789 |
|                   30 |           123456789123456789.123456789123456789 |
|                   31 |           123456789123456789.123456789123456789 |
|  9223372036854775807 |           123456789123456789.123456789123456789 |
+----------------------+-------------------------------------------------+

# variable input & frac

mysql> set @@session.tidb_isolation_read_engines='tiflash'; select count(*), round(a, i) as v from test.i64 cross join test.t group by v order by v
+----------+----------------------+
| count(*) | v                    |
+----------+----------------------+
|      100 |                 NULL |
|       88 | -9223372036854775808 |
|        1 | -9223372036850000896 |
|        1 | -9223372000000001024 |
|        1 | -9223372000000000000 |
|        1 | -9223370000000000000 |
|        1 | -9222999999999998976 |
|        1 | -9220000000000000000 |
|        1 | -9199999999999998976 |
|        1 | -8999999999999998976 |
|      102 | -5000000000000000000 |
|       31 |                   -5 |
|       35 |                   -4 |
|      660 |                    0 |
|       35 |                    4 |
|       31 |                    5 |
|      102 |  5000000000000000000 |
|        1 |  8999999999999998976 |
|        1 |  9199999999999998976 |
|        1 |  9220000000000000000 |
|        1 |  9222999999999998976 |
|        1 |  9223370000000000000 |
|        1 |  9223372000000000000 |
|        1 |  9223372000000001024 |
|        1 |  9223372036850000896 |
+----------+----------------------+

mysql> set @@session.tidb_isolation_read_engines='tiflash'; select count(*), round(a, i) as v from test.f64 cross join test.t group by v order by v
+----------+---------------------+
| count(*) | v                   |
+----------+---------------------+
|      100 |                NULL |
|        3 | -500000000000.00006 |
|       36 |       -500000000000 |
|        6 | -499999999999.99994 |
|        1 | -490000000000.00006 |
|       39 |       -490000000000 |
|        3 | -489999999999.99994 |
|       30 |                -2.5 |
|        2 | -2.4999999999999996 |
|        1 |                  -2 |
|       31 |               -0.25 |
|        1 |                -0.2 |
|        3 |     -0.000000000025 |
|       18 |     -0.000000000025 |
|        1 |      -0.00000000002 |
|      498 |                   0 |
|      320 |                  -0 |
|        1 |       0.00000000002 |
|        3 |      0.000000000025 |
|       18 |      0.000000000025 |
|        1 |                 0.2 |
|       31 |                0.25 |
|       32 |                 0.3 |
|        1 |                   2 |
|        2 |  2.4999999999999996 |
|       30 |                 2.5 |
|        3 |  489999999999.99994 |
|       39 |        490000000000 |
|        1 |  490000000000.00006 |
|        6 |  499999999999.99994 |
|       36 |        500000000000 |
|        3 |  500000000000.00006 |
+----------+---------------------+

mysql> set @@session.tidb_isolation_read_engines='tiflash'; select count(*), round(a, i) as v from test.d9 cross join test.t group by v order by v
+----------+--------------+
| count(*) | v            |
+----------+--------------+
|      100 |         NULL |
|       10 |      -100000 |
|       29 |  -99999.9999 |
|       45 |       -50000 |
|       29 |  -49999.9999 |
|        1 |          -30 |
|       33 |          -25 |
|        1 |         -0.3 |
|       31 |        -0.25 |
|        1 |         -0.1 |
|       33 |        -0.05 |
|       29 |      -0.0499 |
|     1016 |            0 |
|       29 |       0.0499 |
|       33 |         0.05 |
|        1 |          0.1 |
|       31 |         0.25 |
|        1 |          0.3 |
|       33 |           25 |
|        1 |           30 |
|       29 |   49999.9999 |
|       45 |        50000 |
|       29 |   99999.9999 |
|       10 |       100000 |
+----------+--------------+

mysql> set @@session.tidb_isolation_read_engines='tiflash'; select count(*), round(a, i) as v from test.d64 cross join test.t group by v order by v
+----------+--------------------------------------------------------------------+
| count(*) | v                                                                  |
+----------+--------------------------------------------------------------------+
|      100 |                                                               NULL |
|       65 |   -100000000000000000000000000000000000000000000000000000000000000 |
|       31 | -99999999999999999999999999999999999999999999999999999999999999.99 |
|      157 |    -50000000000000000000000000000000000000000000000000000000000000 |
|       31 | -49999999999999999999999999999999999999999999999999999999999999.99 |
|        1 |                                                                -30 |
|       33 |                                                                -25 |
|        1 |                                                                 -1 |
|       33 |                                                               -0.5 |
|       31 |                                                              -0.49 |
|        1 |                                                               -0.3 |
|       31 |                                                              -0.25 |
|      670 |                                                                  0 |
|       31 |                                                               0.25 |
|        1 |                                                                0.3 |
|       31 |                                                               0.49 |
|       33 |                                                                0.5 |
|        1 |                                                                  1 |
|       33 |                                                                 25 |
|        1 |                                                                 30 |
|       31 |  49999999999999999999999999999999999999999999999999999999999999.99 |
|      157 |     50000000000000000000000000000000000000000000000000000000000000 |
|       31 |  99999999999999999999999999999999999999999999999999999999999999.99 |
|       65 |    100000000000000000000000000000000000000000000000000000000000000 |
+----------+--------------------------------------------------------------------+
