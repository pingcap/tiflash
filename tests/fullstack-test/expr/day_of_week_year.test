mysql> drop table if exists test.t;
mysql> create table test.t(a char(20), b datetime, c date);
mysql> insert into test.t values('', '1970-1-1 12:12:12', '1970-1-1');
mysql> insert into test.t values('123', '1989-6-6 12:12:12', '1989-6-6');
mysql> insert into test.t values('2022-3-10', '2000-3-4 12:12:12', '2000-3-4');
mysql> insert into test.t values('2050-15-15', '2050-12-2 12:12:12', '2050-12-2');
mysql> alter table test.t set tiflash replica 1;

func> wait_table test t

mysql> set @@tidb_isolation_read_engines='tiflash'; set @@tidb_enforce_mpp = 1; select dayofweek(a), dayofweek(b), dayofweek(c) from test.t;
+--------------+--------------+--------------+
| dayofweek(a) | dayofweek(b) | dayofweek(c) |
+--------------+--------------+--------------+
|         NULL |            5 |            5 |
|         NULL |            3 |            3 |
|            5 |            7 |            7 |
|         NULL |            6 |            6 |
+--------------+--------------+--------------+

mysql> set @@tidb_isolation_read_engines='tiflash'; set @@tidb_enforce_mpp = 1; select dayofyear(a), dayofyear(b), dayofyear(c) from test.t;
+--------------+--------------+--------------+
| dayofyear(a) | dayofyear(b) | dayofyear(c) |
+--------------+--------------+--------------+
|         NULL |            1 |            1 |
|         NULL |          157 |          157 |
|           69 |           64 |           64 |
|         NULL |          336 |          336 |
+--------------+--------------+--------------+

mysql> drop table if exists test.t;
