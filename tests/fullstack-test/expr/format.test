mysql> drop table if exists test.t
mysql> create table test.t(a float, b double, c decimal(20, 10), d int, e varchar(20))
mysql> alter table test.t set tiflash replica 1
mysql> insert into test.t values (12.1235, 12.1235, 12.1235, 5, 'en_US'),(12.1235, 12.1235, 12.1235, 4, 'enUS'),(12.1235, 12.1235, 12.1235, 3, null)

func> wait_table test t

mysql> set tidb_allow_mpp=1; set tidb_isolation_read_engines='tiflash'; select float_val, double_val, decimal_val from (select format(a, d, e) as float_val, format(b, d, e) as double_val, format(c, d, e) as decimal_val from test.t) t group by float_val, double_val, decimal_val
+-----------+------------+-------------+
| float_val | double_val | decimal_val |
+-----------+------------+-------------+
| 12.12350  | 12.12350   | 12.12350    |
| 12.1235   | 12.1235    | 12.1235     |
| 12.124    | 12.124     | 12.124      |
+-----------+------------+-------------+

mysql> drop table if exists test.t
