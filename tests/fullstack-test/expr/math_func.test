mysql> drop table if exists test.t
mysql> create table test.t(ld decimal(10,2), bd decimal(50, 25), f float, i integer, c char(10), vc varchar(10))
mysql> alter table test.t set tiflash replica 1
mysql> insert into test.t values(-2.5, 2.5, 0.25, 4, 'af', 'bc')

func> wait_table test t


mysql> select /*+ AGG_TO_COP(), READ_FROM_STORAGE(TIFLASH[t]) */ sum(sqrt(ld)), sum(sqrt(bd)), sum(sqrt(f)), sum(sqrt(i)) from test.t;
+---------------+---------------+--------------+--------------+
| sum(sqrt(ld)) | sum(sqrt(bd)) | sum(sqrt(f)) | sum(sqrt(i)) |
+---------------+---------------+--------------+--------------+
|           1.1 |           1.2 |          0.5 |            2 |
+---------------+---------------+--------------+--------------+

mysql> select /*+ AGG_TO_COP(), READ_FROM_STORAGE(TIFLASH[t]) */ sum(sign(ld)), sum(sign(bd)), sum(sign(f)), sum(sign(i)) from test.t;
+---------------+---------------+--------------+--------------+
| sum(sign(ld)) | sum(sign(bd)) | sum(sign(f)) | sum(sign(i)) |
+---------------+---------------+--------------+--------------+
|            -1 |             1 |            1 |            1 |
+---------------+---------------+--------------+--------------+

mysql> select /*+ AGG_TO_COP(), READ_FROM_STORAGE(TIFLASH[t]) */ sum(ln(ld)), sum(ln(bd)), sum(ln(f)), sum(ln(i)) from test.t;
+-------------+--------------------+---------------------+--------------------+
| sum(ln(ld)) | sum(ln(bd))        | sum(ln(f))          | sum(ln(i))         |
+-------------+--------------------+---------------------+--------------------+
|        NULL | 0.9162907318741551 | -1.3862943611198906 | 1.3862943611198906 |
+-------------+--------------------+---------------------+--------------------+

mysql> select /*+ AGG_TO_COP(), READ_FROM_STORAGE(TIFLASH[t]) */ sum(log2(ld)), sum(log2(bd)), sum(log2(f)), sum(log2(i)) from test.t;
+---------------+--------------------+--------------+--------------+
| sum(log2(ld)) | sum(log2(bd))      | sum(log2(f)) | sum(log2(i)) |
+---------------+--------------------+--------------+--------------+
|          NULL | 1.3219280948873624 |           -2 |            2 |
+---------------+--------------------+--------------+--------------+

mysql> select /*+ AGG_TO_COP(), READ_FROM_STORAGE(TIFLASH[t]) */ sum(log10(ld)), sum(log10(bd)), sum(log10(f)), sum(log10(i)) from test.t;
+----------------+--------------------+---------------------+--------------------+
| sum(log10(ld)) | sum(log10(bd))     | sum(log10(f))       | sum(log10(i))      |
+----------------+--------------------+---------------------+--------------------+
|           NULL | 0.3979400086720376 | -0.6020599913279624 | 0.6020599913279624 |
+----------------+--------------------+---------------------+--------------------+

mysql> select /*+ AGG_TO_COP(), READ_FROM_STORAGE(TIFLASH[t]) */ sum(log(-ld, -ld)), sum(log(-ld, bd)), sum(log(-ld, f)), sum(log(-ld, i)) from test.t;
+--------------------+-------------------+-------------------+------------------+
| sum(log(-ld, -ld)) | sum(log(-ld, bd)) | sum(log(-ld, f))  | sum(log(-ld, i)) |
+--------------------+-------------------+-------------------+------------------+
|                  1 |                 1 | -1.51294159473206 | 1.51294159473206 |
+--------------------+-------------------+-------------------+------------------+

mysql> select /*+ AGG_TO_COP(), READ_FROM_STORAGE(TIFLASH[t]) */ sum(exp(ld)), sum(exp(bd)), sum(exp(f)), sum(exp(i)) from test.t;
+--------------------+--------------------+--------------------+--------------------+
| sum(exp(ld))       | sum(exp(bd))       | sum(exp(f))        | sum(exp(i))        |
+--------------------+--------------------+--------------------+--------------------+
| 0.0820849986238988 | 12.182493960703473 | 1.2840254166877414 | 54.598150033144236 |
+--------------------+--------------------+--------------------+--------------------+

mysql> select /*+ AGG_TO_COP(), READ_FROM_STORAGE(TIFLASH[t]) */ sum(pow(1.1, ld)), sum(pow(1.1, bd)), sum(pow(1.1, f)), sum(pow(1.1, i)) from test.t;
+--------------------+--------------------+--------------------+--------------------+
| sum(pow(1.1, ld))  | sum(pow(1.1, bd))  | sum(pow(1.1, f))   | sum(pow(1.1, i))   |
+--------------------+--------------------+--------------------+--------------------+
| 0.7879856109467703 | 1.2690587062858836 | 1.0241136890844451 | 1.4641000000000004 |
+--------------------+--------------------+--------------------+--------------------+

mysql> select /*+ AGG_TO_COP(), READ_FROM_STORAGE(TIFLASH[t]) */ sum(degrees(ld)), sum(degrees(bd)), sum(degrees(f)), sum(degrees(i)) from test.t;
+--------------------+-------------------+-------------------+-------------------+
| sum(degrees(ld))   | sum(degrees(bd))  | sum(degrees(f))   | sum(degrees(i))   |
+--------------------+-------------------+-------------------+-------------------+
| -143.2394487827058 | 143.2394487827058 | 14.32394487827058 | 229.1831180523293 |
+--------------------+-------------------+-------------------+-------------------+

mysql> select /*+ AGG_TO_COP(), READ_FROM_STORAGE(TIFLASH[t]) */ sum(radians(ld)), sum(radians(bd)), sum(radians(f)), sum(radians(i)) from test.t;
+----------------------+---------------------+----------------------+---------------------+
| sum(radians(ld))     | sum(radians(bd))    | sum(radians(f))      | sum(radians(i))     |
+----------------------+---------------------+----------------------+---------------------+
| -0.04363323129985824 | 0.04363323129985824 | 0.004363323129985824 | 0.06981317007977318 |
+----------------------+---------------------+----------------------+---------------------+

mysql> select /*+ AGG_TO_COP(), READ_FROM_STORAGE(TIFLASH[t]) */ sum(crc32(vc)), sum(crc32(c)) from test.t;
+----------------+---------------+
| sum(crc32(vc)) | sum(crc32(c)) |
+----------------+---------------+
|     3265866552 |    2582547572 |
+----------------+---------------+

mysql> select /*+ AGG_TO_COP(), READ_FROM_STORAGE(TIFLASH[t]) */ sum(cast(conv(c,16,10) as unsigned)), sum(cast(conv(vc,16,10) as unsigned)), sum(cast(conv(c,i+12,i+6) as unsigned)) from test.t;
+--------------------------------------+---------------------------------------+-----------------------------------------+
| sum(cast(conv(c,16,10) as unsigned)) | sum(cast(conv(vc,16,10) as unsigned)) | sum(cast(conv(c,i+12,i+6) as unsigned)) |
+--------------------------------------+---------------------------------------+-----------------------------------------+
|                                  175 |                                   188 |                                     175 |
+--------------------------------------+---------------------------------------+-----------------------------------------+


mysql> drop table if exists test.t


