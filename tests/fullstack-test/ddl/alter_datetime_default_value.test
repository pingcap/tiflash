mysql> drop table if exists test.t
mysql> create table test.t(a int)
mysql> alter table test.t set tiflash replica 1 location labels 'rack', 'host', 'abc'

SLEEP 15

mysql> insert into test.t values (1);
mysql> set session tidb_isolation_read_engines='tiflash'; select * from test.t;
+---+
| a |
+---+
| 1 |
+---+

mysql> alter table test.t add date_0 DATE NULL DEFAULT '1000-01-01' 
mysql> alter table test.t add date_1 DATE NULL DEFAULT '9999-12-31' 
mysql> alter table test.t add date_a DATE NOT NULL

mysql> alter table test.t add time_0 TIME NULL DEFAULT '59' 
mysql> alter table test.t add time_1 TIME(6) NULL DEFAULT '-838:59:59.000000' 
mysql> alter table test.t add time_2 TIME(6) NULL DEFAULT '838:59:59.000000' 
mysql> alter table test.t add time_3 TIME(6) NULL DEFAULT '0' 
mysql> alter table test.t add time_a TIME NOT NULL
mysql> alter table test.t add time_b TIME(6) NOT NULL

mysql> alter table test.t add datetime_0 DATETIME(6) NULL DEFAULT '1000-01-01 00:00:00.000000' 
mysql> alter table test.t add datetime_1 DATETIME(6) NULL DEFAULT '9999-12-31 23:59:59.000000' 
mysql> alter table test.t add datetime_a DATETIME NOT NULL
mysql> alter table test.t add datetime_b DATETIME(6) NOT NULL

SLEEP 15

mysql> set session tidb_isolation_read_engines='tiflash'; select * from test.t;
+------+------------+------------+------------+----------+-------------------+------------------+-----------------+----------+-----------------+----------------------------+----------------------------+---------------------+----------------------------+
| a    | date_0     | date_1     | date_a     | time_0   | time_1            | time_2           | time_3          | time_a   | time_b          | datetime_0                 | datetime_1                 | datetime_a          | datetime_b                 |
+------+------------+------------+------------+----------+-------------------+------------------+-----------------+----------+-----------------+----------------------------+----------------------------+---------------------+----------------------------+
|    1 | 1000-01-01 | 9999-12-31 | 0000-00-00 | 00:00:59 | -838:59:59.000000 | 838:59:59.000000 | 00:00:00.000000 | 00:00:00 | 00:00:00.000000 | 1000-01-01 00:00:00.000000 | 9999-12-31 23:59:59.000000 | 0000-00-00 00:00:00 | 0000-00-00 00:00:00.000000 |
+------+------------+------------+------------+----------+-------------------+------------------+-----------------+----------+-----------------+----------------------------+----------------------------+---------------------+----------------------------+

>> desc test.t
┌─name────────┬─type────────────────────┬─default_type─┬─default_expression───────────────────────────────────┐
│ a           │ Nullable(Int32)         │              │                                                      │
│ _tidb_rowid │ Int64                   │              │                                                      │
│ date_0      │ Nullable(MyDate)        │ DEFAULT      │ CAST(914866242077065216 AS Nullable(MyDate))         │
│ date_1      │ Nullable(MyDate)        │ DEFAULT      │ CAST(9147934544073064448 AS Nullable(MyDate))        │
│ date_a      │ MyDate                  │ DEFAULT      │ CAST(0 AS MyDate)                                    │
│ time_0      │ Nullable(Int64)         │ DEFAULT      │ CAST(59000000000 AS Nullable(Int64))                 │
│ time_1      │ Nullable(Int64)         │ DEFAULT      │ CAST(-3020399000000000 AS Nullable(Int64))           │
│ time_2      │ Nullable(Int64)         │ DEFAULT      │ CAST(3020399000000000 AS Nullable(Int64))            │
│ time_3      │ Nullable(Int64)         │ DEFAULT      │ CAST(0 AS Nullable(Int64))                           │
│ time_a      │ Int64                   │ DEFAULT      │ CAST(0 AS Int64)                                     │
│ time_b      │ Int64                   │ DEFAULT      │ CAST(0 AS Int64)                                     │
│ datetime_0  │ Nullable(MyDateTime(6)) │ DEFAULT      │ CAST(914866242077065216 AS Nullable(MyDateTime(6)))  │
│ datetime_1  │ Nullable(MyDateTime(6)) │ DEFAULT      │ CAST(9147936188961652736 AS Nullable(MyDateTime(6))) │
│ datetime_a  │ MyDateTime(0)           │ DEFAULT      │ CAST(0 AS MyDateTime(0))                             │
│ datetime_b  │ MyDateTime(6)           │ DEFAULT      │ CAST(0 AS MyDateTime(6))                             │
└─────────────┴─────────────────────────┴──────────────┴──────────────────────────────────────────────────────┘


### tests for timestamp
mysql> drop table if exists test.t
mysql> create table test.t(a int)
mysql> alter table test.t set tiflash replica 1 location labels 'rack', 'host', 'abc'

SLEEP 15

mysql> insert into test.t values (1);

# The min, max, 0 is related to time zone of the machine
#mysql> alter table test.t add timestamp_0 TIMESTAMP(6) NULL DEFAULT '1970-01-01 00:00:01.000000' 
#mysql> alter table test.t add timestamp_1 TIMESTAMP(6) NULL DEFAULT '2038-01-19 03:14:07.999999' 
#mysql> alter table test.t add timestamp_2 TIMESTAMP(6) NULL DEFAULT '0000-00-00 00:00:00.000000' 
#mysql> alter table test.t add timestamp_0 TIMESTAMP(6) NULL DEFAULT '2000-01-20 03:14:07.999999' 
mysql> alter table test.t add timestamp_a TIMESTAMP NOT NULL
mysql> alter table test.t add timestamp_b TIMESTAMP(6) NOT NULL

SLEEP 15

mysql> set session tidb_isolation_read_engines='tiflash'; select * from test.t;
+------+---------------------+----------------------------+
| a    | timestamp_a         | timestamp_b                |
+------+---------------------+----------------------------+
|    1 | 0000-00-00 00:00:00 | 0000-00-00 00:00:00.000000 |
+------+---------------------+----------------------------+

>> desc test.t
┌─name────────┬─type────────────┬─default_type─┬─default_expression───────┐
│ a           │ Nullable(Int32) │              │                          │
│ _tidb_rowid │ Int64           │              │                          │
│ timestamp_a │ MyDateTime(0)   │ DEFAULT      │ CAST(0 AS MyDateTime(0)) │
│ timestamp_b │ MyDateTime(6)   │ DEFAULT      │ CAST(0 AS MyDateTime(6)) │
└─────────────┴─────────────────┴──────────────┴──────────────────────────┘

mysql> drop table if exists test.t

### tests for year
mysql> drop table if exists test.t
mysql> create table test.t(a int)
mysql> alter table test.t set tiflash replica 1 location labels 'rack', 'host', 'abc'

SLEEP 15

mysql> insert into test.t values (1);
mysql> alter table test.t add year_0 YEAR NULL DEFAULT '1901' 
mysql> alter table test.t add year_1 YEAR NULL DEFAULT '2155' 
mysql> alter table test.t add year_2 YEAR NULL DEFAULT '0000' 
mysql> alter table test.t add year_a YEAR NOT NULL

#TODO: fix zero value for year
#SLEEP 15
#mysql> set session tidb_isolation_read_engines='tiflash'; select * from test.t;
#+------+--------+--------+--------+--------+
#| a    | year_0 | year_1 | year_2 | year_a |
#+------+--------+--------+--------+--------+
#|    1 |   1901 |   2155 |   0000 |   2000 |
#+------+--------+--------+--------+--------+

#>> desc test.t
